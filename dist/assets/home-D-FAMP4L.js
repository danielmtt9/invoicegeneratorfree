const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/react-pdf.browser-3tEyuls0.js","assets/Layout-DsosNlEA.js","assets/Layout-CZSGeCF6.css","assets/InvoicePdf-BQO6_44B.js"])))=>i.map(i=>d[i]);
import{r as A,a as b,j as e,t as I,R as E,C as k,S as M}from"./Layout-DsosNlEA.js";const L="modulepreload",U=function(t){return"/"+t},P={},w=function(s,c,l){let o=Promise.resolve();if(c&&c.length>0){let h=function(u){return Promise.all(u.map(p=>Promise.resolve(p).then(v=>({status:"fulfilled",value:v}),v=>({status:"rejected",reason:v}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),j=(d==null?void 0:d.nonce)||(d==null?void 0:d.getAttribute("nonce"));o=h(c.map(u=>{if(u=U(u),u in P)return;P[u]=!0;const p=u.endsWith(".css"),v=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${v}`))return;const x=document.createElement("link");if(x.rel=p?"stylesheet":L,p||(x.as="script"),x.crossOrigin="",x.href=u,j&&x.setAttribute("nonce",j),document.head.appendChild(x),p)return new Promise((n,r)=>{x.addEventListener("load",n),x.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(h){const d=new Event("vite:preloadError",{cancelable:!0});if(d.payload=h,window.dispatchEvent(d),!d.defaultPrevented)throw h}return o.then(h=>{for(const d of h||[])d.status==="rejected"&&a(d.reason);return s().catch(a)})};function _(t,s){const c=URL.createObjectURL(t),l=document.createElement("a");l.href=c,l.download=s,document.body.appendChild(l),l.click(),l.remove(),URL.revokeObjectURL(c)}async function B(t){const[{pdf:s},{InvoicePdf:c}]=await Promise.all([w(()=>import("./react-pdf.browser-3tEyuls0.js"),__vite__mapDeps([0,1,2])),w(()=>import("./InvoicePdf-BQO6_44B.js"),__vite__mapDeps([3,1,2,0]))]),l=A.createElement(c,{draft:t}),o=await s(l).toBlob(),a=(t.invoiceNo||"invoice").replace(/[^a-zA-Z0-9._-]+/g,"-");_(o,`${a}.pdf`)}function N(t){const s=typeof t=="number"?t:Number(t);return Number.isFinite(s)?s:0}function f(t,s,c){return Math.min(c,Math.max(s,t))}function O(t){const s=t.items.map(r=>{const i=N(r.qty),y=N(r.rate),g=i*y,T=f(N(r.discountPct),0,100),C=g*(T/100);return{lineAmount:g,lineDiscount:C}}),c=s.reduce((r,i)=>r+i.lineAmount,0),l=s.reduce((r,i)=>r+i.lineDiscount,0),o=c-l,a=Math.max(0,N(t.shippingFee)),h=Math.max(0,o+a),d=f(N(t.invoiceDiscountAmount),0,h),j=o-d+a,u=Math.max(0,N(t.taxRatePct)),p=j*(u/100),v=j+p,x=f(N(t.amountPaid),0,Math.max(0,v)),n=v-x;return{lineSubtotal:c,lineDiscountTotal:l,subtotal:o,invoiceDiscountAmountApplied:d,shippingFeeApplied:a,taxableBase:j,tax:p,grandTotal:v,amountPaidApplied:x,balanceDue:n}}const q=["USD","EUR","GBP","CAD","AUD","INR","JPY"],D="invoice.logoDataUrl",G=5*1024*1024,$=new Set(["image/png","image/jpeg"]);function m(t,s){return new Intl.NumberFormat(void 0,{style:"currency",currency:s}).format(t)}function S(){const t=new Date,s=String(t.getFullYear()),c=String(t.getMonth()+1).padStart(2,"0"),l=String(t.getDate()).padStart(2,"0");return`${s}-${c}-${l}`}function F(){return Math.random().toString(16).slice(2)+Date.now().toString(16)}function R(t=""){return{invoiceNo:"INV-0001",poNo:"",issueDate:S(),dueDate:S(),paymentTerms:"Payment due within 15 days",from:`Your Company
Street
City, State ZIP`,billTo:`Client Name
Street
City, State ZIP`,notes:"Thanks for your business.",bankDetails:`Bank name
Account name
Account number / IBAN
Routing / SWIFT`,currency:"USD",taxRatePct:0,invoiceDiscountAmount:0,shippingFee:0,amountPaid:0,logoDataUrl:t,items:[{id:F(),description:"Service or product",qty:1,rate:100,discountPct:0}]}}function Y(){if(typeof window>"u")return"";try{return window.localStorage.getItem(D)||""}catch{return""}}function W(t){const s=Number.isFinite(t.qty)?t.qty:0,c=Number.isFinite(t.rate)?t.rate:0,l=Number.isFinite(t.discountPct)?t.discountPct:0,o=Math.min(100,Math.max(0,l)),a=s*c;return a-a*(o/100)}function V(){const[t,s]=b.useState(()=>R(Y())),[c,l]=b.useState(""),o=b.useMemo(()=>O({items:t.items,taxRatePct:t.taxRatePct,invoiceDiscountAmount:t.invoiceDiscountAmount,shippingFee:t.shippingFee,amountPaid:t.amountPaid}),[t.items,t.taxRatePct,t.invoiceDiscountAmount,t.shippingFee,t.amountPaid]);function a(n,r){s(i=>({...i,[n]:r}))}function h(n,r){s(i=>({...i,items:i.items.map(y=>y.id===n?{...y,...r}:y)}))}function d(){s(n=>({...n,items:[...n.items,{id:F(),description:"",qty:1,rate:0,discountPct:0}]}))}function j(n){s(r=>({...r,items:r.items.filter(i=>i.id!==n)}))}function u(){try{window.localStorage.removeItem(D)}catch{}s(n=>({...n,logoDataUrl:""})),l("")}async function p(n){if(!n)return;if(!$.has(n.type)){l("Use a PNG or JPG image.");return}if(n.size>G){l("Logo must be 5MB or smaller.");return}let r="";try{r=await new Promise((i,y)=>{const g=new FileReader;g.onerror=()=>y(new Error("Failed to read image file.")),g.onload=()=>i(typeof g.result=="string"?g.result:""),g.readAsDataURL(n)})}catch{l("Failed to load logo file.");return}if(!r){l("Failed to load logo file.");return}try{window.localStorage.setItem(D,r)}catch{}s(i=>({...i,logoDataUrl:r})),l("")}async function v(){await B({invoiceNo:t.invoiceNo,poNo:t.poNo,issueDate:t.issueDate,dueDate:t.dueDate,paymentTerms:t.paymentTerms,from:t.from,billTo:t.billTo,notes:t.notes,bankDetails:t.bankDetails,currency:t.currency,taxRatePct:t.taxRatePct,invoiceDiscountAmount:t.invoiceDiscountAmount,shippingFee:t.shippingFee,amountPaid:t.amountPaid,logoDataUrl:t.logoDataUrl,items:t.items}),I("invoice_pdf_download",{items:t.items.length})}function x(){u(),s(R())}return e.jsx("div",{children:e.jsxs("div",{className:"grid",children:[e.jsxs("section",{className:"panel",children:[e.jsxs("div",{className:"hd invoiceHd",children:[e.jsxs("div",{className:"invoiceHdTitle",children:[e.jsx("img",{className:"invoiceMiniMark",src:"/brand/logo-mark.svg",alt:"","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h2",{children:"Invoice Builder"}),e.jsx("p",{className:"fineMuted",children:"Structured layout with clear spacing and faster data entry."})]})]}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{className:"btn",onClick:x,type:"button",children:"Reset"}),e.jsx("button",{className:"btn primary",onClick:()=>void v(),type:"button",children:"Download PDF"})]})]}),e.jsxs("div",{className:"bd invoiceForm",children:[e.jsxs("section",{className:"invoiceSection",children:[e.jsxs("div",{className:"sectionTitleRow",children:[e.jsx("h3",{className:"sectionTitle",children:"Invoice details"}),e.jsxs("div",{className:"pill",children:[e.jsx("span",{children:"Currency"}),e.jsx("strong",{children:t.currency})]})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"invoiceNo",children:"Invoice No."}),e.jsx("input",{id:"invoiceNo",value:t.invoiceNo,onChange:n=>a("invoiceNo",n.target.value),placeholder:"INV-0001"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"poNo",children:"PO number"}),e.jsx("input",{id:"poNo",value:t.poNo,onChange:n=>a("poNo",n.target.value),placeholder:"PO-1001"})]})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currency",children:"Currency"}),e.jsx("select",{id:"currency",value:t.currency,onChange:n=>a("currency",n.target.value),children:q.map(n=>e.jsx("option",{value:n,children:n},n))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"paymentTerms",children:"Payment terms"}),e.jsx("input",{id:"paymentTerms",value:t.paymentTerms,onChange:n=>a("paymentTerms",n.target.value),placeholder:"Payment due within 15 days"}),e.jsx("div",{className:"fineMuted",children:"Add due terms, accepted methods, and any late-fee policy."})]})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"issueDate",children:"Issue date"}),e.jsx("input",{id:"issueDate",type:"date",value:t.issueDate,onChange:n=>a("issueDate",n.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"dueDate",children:"Due date"}),e.jsx("input",{id:"dueDate",type:"date",value:t.dueDate,onChange:n=>a("dueDate",n.target.value)})]})]}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"logo",children:"Logo"}),e.jsx("input",{id:"logo",type:"file",accept:".png,.jpg,.jpeg,image/png,image/jpeg",onChange:n=>{var i;const r=((i=n.target.files)==null?void 0:i[0])||null;p(r)}}),e.jsx("div",{className:"fineMuted",children:"JPG/PNG up to 5MB. Stored locally in your browser only."}),c?e.jsx("div",{className:"fineMuted",children:c}):null,t.logoDataUrl?e.jsxs("div",{className:"logoPreviewRow",children:[e.jsx("img",{src:t.logoDataUrl,alt:"Invoice logo preview",className:"logoThumb"}),e.jsx("button",{className:"btn",type:"button",onClick:u,children:"Remove logo"})]}):null]}),e.jsxs("div",{className:"pill pillTall",children:[e.jsx("span",{children:"PDF export"}),e.jsx("strong",{children:"Ready"})]})]})]}),e.jsxs("section",{className:"invoiceSection",children:[e.jsx("h3",{className:"sectionTitle",children:"Parties"}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"from",children:"From"}),e.jsx("textarea",{id:"from",value:t.from,onChange:n=>a("from",n.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"billTo",children:"Bill to"}),e.jsx("textarea",{id:"billTo",value:t.billTo,onChange:n=>a("billTo",n.target.value)})]})]})]}),e.jsxs("section",{className:"invoiceSection",children:[e.jsx("h3",{className:"sectionTitle",children:"Items"}),e.jsx("div",{className:"itemsTableWrap",children:e.jsxs("table",{className:"itemsTable",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",style:{width:"44%"},children:"Description"}),e.jsx("th",{scope:"col",className:"num",style:{width:"9%"},children:"Qty"}),e.jsx("th",{scope:"col",className:"num",style:{width:"12%"},children:"Rate"}),e.jsx("th",{scope:"col",className:"num",style:{width:"11%"},children:"Disc %"}),e.jsx("th",{scope:"col",className:"num",style:{width:"14%"},children:"Amount"}),e.jsx("th",{scope:"col"})]})}),e.jsx("tbody",{children:t.items.map(n=>{const r=W(n);return e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{value:n.description,onChange:i=>h(n.id,{description:i.target.value}),placeholder:"Line item description"})}),e.jsx("td",{className:"num",children:e.jsx("input",{inputMode:"decimal",value:String(n.qty),onChange:i=>h(n.id,{qty:Number(i.target.value)})})}),e.jsx("td",{className:"num",children:e.jsx("input",{inputMode:"decimal",value:String(n.rate),onChange:i=>h(n.id,{rate:Number(i.target.value)})})}),e.jsx("td",{className:"num",children:e.jsx("input",{inputMode:"decimal",value:String(n.discountPct),onChange:i=>h(n.id,{discountPct:Number(i.target.value)})})}),e.jsx("td",{className:"num",children:m(r,t.currency)}),e.jsx("td",{className:"num",children:e.jsx("button",{className:"btn danger",onClick:()=>j(n.id),type:"button",children:"Remove"})})]},n.id)})})]})}),e.jsxs("div",{className:"itemsActions",children:[e.jsx("button",{className:"btn",onClick:d,type:"button",children:"Add item"}),e.jsx("span",{className:"pill",children:"Line discounts are percent-based."})]})]}),e.jsxs("section",{className:"invoiceSection",children:[e.jsx("h3",{className:"sectionTitle",children:"Payment & totals"}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"notes",children:"Notes / payment terms"}),e.jsx("textarea",{id:"notes",value:t.notes,onChange:n=>a("notes",n.target.value)})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"bankDetails",children:"Bank / payment details"}),e.jsx("textarea",{id:"bankDetails",value:t.bankDetails,onChange:n=>a("bankDetails",n.target.value)})]})]}),e.jsxs("div",{className:"row totalsRowWrap",children:[e.jsxs("div",{className:"totals totalsInputs",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"taxRatePct",children:"Tax rate (%)"}),e.jsx("input",{id:"taxRatePct",inputMode:"decimal",value:String(t.taxRatePct),onChange:n=>a("taxRatePct",Number(n.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"invoiceDiscountAmount",children:"Invoice discount"}),e.jsx("input",{id:"invoiceDiscountAmount",inputMode:"decimal",value:String(t.invoiceDiscountAmount),onChange:n=>a("invoiceDiscountAmount",Number(n.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"shippingFee",children:"Shipping fee"}),e.jsx("input",{id:"shippingFee",inputMode:"decimal",value:String(t.shippingFee),onChange:n=>a("shippingFee",Number(n.target.value))})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"amountPaid",children:"Amount paid"}),e.jsx("input",{id:"amountPaid",inputMode:"decimal",value:String(t.amountPaid),onChange:n=>a("amountPaid",Number(n.target.value))})]})]}),e.jsxs("div",{className:"totals totalsSummary",children:[e.jsxs("div",{className:"totalRow",children:[e.jsx("span",{children:"Line subtotal"}),e.jsx("span",{children:m(o.lineSubtotal,t.currency)})]}),e.jsxs("div",{className:"totalRow",children:[e.jsx("span",{children:"Line discounts"}),e.jsxs("span",{children:["-",m(o.lineDiscountTotal,t.currency)]})]}),e.jsxs("div",{className:"totalRow",children:[e.jsx("span",{children:"Subtotal"}),e.jsx("span",{children:m(o.subtotal,t.currency)})]}),e.jsxs("div",{className:"totalRow",children:[e.jsx("span",{children:"Invoice discount"}),e.jsxs("span",{children:["-",m(o.invoiceDiscountAmountApplied,t.currency)]})]}),e.jsxs("div",{className:"totalRow",children:[e.jsx("span",{children:"Shipping"}),e.jsx("span",{children:m(o.shippingFeeApplied,t.currency)})]}),e.jsxs("div",{className:"totalRow",children:[e.jsx("span",{children:"Tax"}),e.jsx("span",{children:m(o.tax,t.currency)})]}),e.jsxs("div",{className:"totalRow totalStrongRow",children:[e.jsx("strong",{children:"Grand total"}),e.jsx("strong",{children:m(o.grandTotal,t.currency)})]}),e.jsxs("div",{className:"totalRow",children:[e.jsx("span",{children:"Amount paid"}),e.jsx("span",{children:m(o.amountPaidApplied,t.currency)})]}),e.jsxs("div",{className:"totalRow totalAccentRow",children:[e.jsx("strong",{children:"Balance due"}),e.jsx("strong",{children:m(o.balanceDue,t.currency)})]})]})]})]})]})]}),e.jsxs("aside",{className:"panel",children:[e.jsx("div",{className:"hd",children:e.jsx("h2",{children:"Preview"})}),e.jsxs("div",{className:"bd",children:[e.jsxs("div",{className:"previewBrand",children:[e.jsx("img",{src:"/brand/logo-mark.svg",alt:"","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("strong",{children:t.invoiceNo||"Untitled"}),e.jsxs("div",{className:"fineMuted",children:[t.currency," invoice"]})]})]}),e.jsxs("div",{style:{color:"var(--muted)",fontSize:13,whiteSpace:"pre-wrap",lineHeight:1.45},children:[e.jsx("strong",{style:{color:"var(--text)"},children:"From"}),`
`,t.from,`

`,e.jsx("strong",{style:{color:"var(--text)"},children:"Bill to"}),`
`,t.billTo,`

`,e.jsx("strong",{style:{color:"var(--text)"},children:"Details"}),`
`,"Invoice: ",t.invoiceNo||"-",`
`,"PO: ",t.poNo||"-",`
`,"Currency: ",t.currency,`
`,"Terms: ",t.paymentTerms||"-",`
`,"Issue: ",t.issueDate,`
`,"Due: ",t.dueDate,`

`,e.jsx("strong",{style:{color:"var(--text)"},children:"Totals"}),`
`,"Subtotal: ",m(o.subtotal,t.currency),`
`,"Tax: ",m(o.tax,t.currency),`
`,"Grand total: ",m(o.grandTotal,t.currency),`
`,"Paid: ",m(o.amountPaidApplied,t.currency),`
`,"Balance due: ",m(o.balanceDue,t.currency),`

`,e.jsx("strong",{style:{color:"var(--text)"},children:"Bank / payment details"}),`
`,t.bankDetails,`

`,e.jsx("strong",{style:{color:"var(--text)"},children:"Notes"}),`
`,t.notes]})]})]})]})})}E.createRoot(document.getElementById("root")).render(e.jsx(A.StrictMode,{children:e.jsx(k,{children:e.jsx(M,{title:"Create an invoice",children:e.jsx(V,{})})})}));export{O as c};
